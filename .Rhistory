search()
sessionInfo()
summary(gee_exch)
summary(gee_exch)$coef
summary(gee_exch)$coef[AcquisitionMB.8,]
summary(gee_exch)$coef["AcquisitionMB.8",]
summary(gee_exch)$coef["AcquisitionMB.8","Wald"]
summary(gee_exch)$coef["AcquisitionMB.8",]
summary(gee_exch)
summary(gee_exch)$coef[,"Wald"]
summary(gee_exch)$coef["AcquisitionMB.8","Wald"]
summary(gee_exch)$coef["AcquisitionMB.8",]
summary(gee_exch)$coef["AcquisitionMB.8",]
geepack:;geeglm
geepack::geeglm
summary(gee_exch)$coef["AcquisitionMB.8","Wald"]
round(summary(gee_exch)$coef["AcquisitionMB.8","Wald"],2)
round(summary(gee_exch)$coef["AcquisitionMB.8","Wald"],5)
(summary(gee_exch)$coef["AcquisitionMB.8","Wald"],)
geepack::geeglm()
detach("package:geeglm")
detach("package:geepack")
detach("package:geepack()")
detach("packages:geepack")
detach("packages::geepack")
detach("packages:geepack")
detach("package::geepack")
geepack
geeglm
geepack::geeglm()
search()
Z_lmm = summary(lmm_all_ac)$coef["AcquisitionMB.8","t value"]
Z_lmm
t_lmm = summary(lmm_all_ac)$coef["AcquisitionMB.8","t value"]
Z_lmm = t_lmm ^2
Z_lmm
sprintf("%.3f", Z_lmm)
Z_gee_exch = summary(gee_exch)$coef["AcquisitionMB.8","Wald"]
Z_gee_exch
sprintf("%.2f", Z_gee_exch)
sprintf("%.2f", Z_lmm)
gee_unstr <-geepack::geeglm(
zcor ~ Acquisition + gender + scanner,
id = id, data = mbdata, family = gaussian(),
corstr = unstructured)
gee_unstr <-geepack::geeglm(
zcor ~ Acquisition + gender + scanner,
id = id, data = mbdata, family = gaussian(),
corstr = "unstructured")
summary(gee_unstr)
alpha_values <- gee_unstructured$geese[[2]]
alpha_values <- gee_unstr$geese[[2]]
corr_yi1_yi8 <- alpha_values["alpha.1:8"]
corr_yi1_yi8
alpha_unstr <- gee_unstr$geese$alpha
alpha_unstr
alpha_unstr = gee_unstr$geese$alpha
corr_yi1_yi8 = alpha_unstr["alpha.1:8"]
corr_yi1_yi8
corr_yi1_yi8 = gee_unstr$geese$alpha["alpha.1:8"]
corr_yi1_yi8
corr_yi2_yi9 <- gee_unstr$geese$alpha["alpha.2:9"]
corr_yi2_yi9
corr_yi1_yi8 = gee_unstr$geese$alpha["alpha.1:8"]
corr_yi2_yi9 <- gee_unstr$geese$alpha["alpha.2:9"]
corr_yi1_yi8
corr_yi2_yi9
qic_exchangeable <- QIC(gee_exchangeable)
qic_exch <- QIC(gee_exch)
qic_exch = QIC(gee_exch)
qic_exch = geepack::QIC(gee_exch)
qic_exch = geepack::QIC(gee_exch)
qic_unstr = geepack::QIC(gee_unstr)
qic_table = data.frame(
Model = rep(c("Exchangeable", "Unstructured"), each = length(qic_exch)),
QICs = rep(1:length(qic_unstr), times = 2),
QIC = c(qic_exch, qic_unstr)
)
qic_table_wide = qic_table %>%
pivot_wider(names_from = Model, values_from = QIC)
qic_table_wide
qic_exch
qic_table_wide
qic_exch
rep(1:length(qic_unstr), times = 2)
QIC = c(qic_exch, qic_unstr)
c(qic_exch, qic_unstr)
cbind(qic_exch, qic_unstr)
qic_exch = geepack::QIC(gee_exch)
qic_unstr = geepack::QIC(gee_unstr)
cbind(qic_exch, qic_unstr)
data.frame(cbind(qic_exch, qic_unstr))
knitr::kable(data.frame(cbind(qic_exch, qic_unstr)))
kbitr::kable(cbind(qic_exch,qic_unstr))
knitr::kable(cbind(qic_exch,qic_unstr))
data.frame(cbind(qic_exch, qic_unstr))
print(data.frame(cbind(qic_exch, qic_unstr)))
qic_exch = geepack::QIC(gee_exch)
qic_unstr = geepack::QIC(gee_unstr)
knitr::kable(cbind(qic_exch,qic_unstr))
library(readr)
library(dplyr)
health = read_csv("health.csv") %>%
janitor::clean_names()
health = health %>% mutate(
health = case_when(health=='Poor'~0, TRUE ~ 1),
agegroup = factor(agegroup),
treatment = factor(txt, levels = c("Control","Intervention")),
time_months = case_when(time == 1 ~ 0, time == 2 ~ 3, time == 3 ~ 6, TRUE ~ 12), time = factor(time))
health
library(readr)
library(dplyr)
health = read_csv("health.csv") %>%
janitor::clean_names()
health = health %>% mutate(
health = case_when(health=='Poor'~0, TRUE ~ 1),
agegroup = factor(agegroup),
treatment = factor(txt, levels = c("Control","Intervention")),
time_months = case_when(time == 1 ~ 0, time == 2 ~ 3, time == 3 ~ 6, TRUE ~ 12), time = factor(time))
health
health = read_csv("health.csv") %>%
janitor::clean_names()
health
detach("package:readr")
health = read_csv("health.csv") %>% janitor::clean_names()
health = readr::read_csv("health.csv") %>% janitor::clean_names()
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
# library(readr)
# detach("package:readr")
# library(dplyr)
health = readr::read_csv("health.csv") %>% janitor::clean_names()
health = health %>% mutate(
health = case_when(health=='Poor'~0, TRUE ~ 1),
agegroup = factor(agegroup),
treatment = factor(txt, levels = c("Control","Intervention")),
time_months = case_when(time == 1 ~ 0,
time == 2 ~ 3,
time == 3 ~ 6,
TRUE ~ 12),
time = factor(time))
+
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
glmm
summary(glmm)
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
lme4::glmer(health ~ time_months + treatment + agegroup + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
lme4::glmer(health ~ time_months + treatment * agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
glmm2 = lme4::glmer(health ~ time_months + treatment + agegroup + treatment*agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm2)
glmm3 = lme4::glmer(health ~ time_months + treatment*agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm3)
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
glmm = lme4::glmer(health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link="logit"))
summary(glmm)
glmm_nAGQ50 = glmer(
health ~ time_months + treatment * agegroup + (1 | id),
data = health,
family = binomial(link = "logit"),
nAGQ = 50
)
glmm_nAGQ50 = lme4::glmer(
health ~ time_months + treatment * agegroup + (1 | id),
data = health,
family = binomial(link = "logit"),
nAGQ = 50
)
glmm_nAGQ50 = lme4::glmer(
health ~ time_months + treatment * agegroup + (1 | id),
data = health,
family = binomial(link = "logit"),
nAGQ = 50
)
summary(glmm_nAGQ50)
glmm_nAGQ50 = lme4::glmer(
health ~ time_months + treatment + agegroup + treatment:agegroup + (1 | id),
data = health,
family = binomial(link = "logit"),
nAGQ = 50
)
summary(glmm_nAGQ50)
results_nAGQ50 = summary(glmm_nAGQ50)
results_nAGQ50$coef
results_nAGQ50$coefficients
results_nAGQ50$coefficients[5,]
results_nAGQ50$coefficients[[5,]]
results_nAGQ50$coefficients[,]
results_nAGQ50$coefficients[[5],]
results_nAGQ50$coefficients[[],]
results_nAGQ50$coefficients[,]
results_nAGQ50$coefficients["agegroup25-34",]
results_nAGQ50$coefficients
OR = exp(results_nAGQ50$coefficients["agegroup25-34","Estimate"])
OR
results_nAGQ50 = summary(glmm_nAGQ50)$coefficient
results_nAGQ50
results = summary(glmm_nAGQ50)$coefficient
results
results
OR = exp(results["agegroup25-34","Estimate"] + results["treatmentIntervention","Estimate"])
OR
OR = exp(results["(Intercept)","Estimate"] + results["agegroup25-34","Estimate"] + results["treatmentIntervention","Estimate"])
OR
OR = exp(results["(Intercept)","Estimate"] + results["agegroup25-34","Estimate"] + results["treatmentIntervention","Estimate"] + results["treatmentIntervention:agegroup25-34","Estimate"]
- (
results["(Intercept)","Estimate"] + results["agegroup25-34","Estimate"]
))
OR
OR
summary(glmm_nAGQ50)$
```
summary(glmm_nAGQ50)
summary(glmm_nAGQ50)$corr
corr(summary(glmm_nAGQ50))
coef(summary(glmm_nAGQ50))
pvalue(summary(glmm_nAGQ50))
pvalue(summary(glmm_nAGQ50))
cov(summary(glmm_nAGQ50))
covariance(summary(glmm_nAGQ50))
covar(summary(glmm_nAGQ50))
vcor(summary(glmm_nAGQ50))
lme4::vcor(summary(glmm_nAGQ50))
lme4::VarCorr(summary(glmm_nAGQ50))
VarCorr(glmm_nAGQ50)
LME4::VarCorr(glmm_nAGQ50)
lme4::VarCorr(glmm_nAGQ50)
data.frame(lme4::VarCorr(glmm_nAGQ50))
data.frame(lme4::vcov(glmm_nAGQ50))
data.frame(vcov(glmm_nAGQ50))
vcov(glmm_nAGQ50)
lme4::VarCorr(summary(glmm_nAGQ50))
vcov(summary(glmm_nAGQ50))
vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["agegroup25-34","Std. Error"]^2 +
results["treatmentIntervention","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
cov_trtInterven_trtIntervenAgeGroup = vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["agegroup25-34","Std. Error"]^2 +
results["treatmentIntervention","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
SE
results["agegroup25-34","Std. Error"]
results["treatmentIntervention","Std. Error"]
results["treatmentIntervention","Std. Error"]
cov_trtInterven_trtIntervenAgeGroup = vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["agegroup25-34","Std. Error"]^2 +
results["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
SE
cov_trtInterven_trtIntervenAgeGroup = vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["treatmentIntervention","Std. Error"]^2 +
results["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
SE
results["treatmentIntervention:agegroup25-34","Std. Error"]
results["treatmentIntervention","Std. Error"]
cov_trtInterven_trtIntervenAgeGroup
SE = sqrt(results["treatmentIntervention","Std. Error"]^2 +
results["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
SE
lowerCI = OR / exp(1.96*SE)
upperCI = OR * exp(1.96*SE)
c(lowerCI, upperCI)
results = coef(summary(glmm_nAGQ50))
results = coef(summary(glmm_nAGQ50))
# i.e., beta_treatmentIntervention + beta_treatmentIntervention:agegroup25-34
OR = exp((results["(Intercept)","Estimate"] +
results["agegroup25-34","Estimate"] +
results["treatmentIntervention","Estimate"] +
results["treatmentIntervention:agegroup25-34","Estimate"])
- (
results["(Intercept)","Estimate"] +
results["agegroup25-34","Estimate"]
))
OR
cov_trtInterven_trtIntervenAgeGroup = vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["treatmentIntervention","Std. Error"]^2 +
results["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
lowerCI = OR / exp(1.96*SE)
upperCI = OR * exp(1.96*SE)
c(lowerCI, upperCI)
CI
cov_trtInterven_trtIntervenAgeGroup = vcov(glmm_nAGQ50)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE = sqrt(results["treatmentIntervention","Std. Error"]^2 +
results["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_trtInterven_trtIntervenAgeGroup)
lowerCI = OR / exp(1.96*SE)
upperCI = OR * exp(1.96*SE)
CI = c(lowerCI, upperCI)
CI
gee_exch_health = geepack::geeglm(
health ~ time_months + treatment + agegroup + treatment:agegroup,
id = id,
data = health,
family = binomial("logit"),
corstr = "exchangeable"
)
summary(gee_exch_health)
coef(gee_exch_health)
coef(glmm_nAGQ50)
coef(summary(glmm_nAGQ50))
coef(gee_exch_health)
coef(summary(glmm_nAGQ50))
pval(summary(glmm_nAGQ50))
pvalue(summary(glmm_nAGQ50))
coef(summary(glmm_nAGQ50))
pvalue(gee_exch_health)
pval(gee_exch_health)
p(gee_exch_health)
summary(gee_exch_health)
summary(glmm_nAGQ50)
summary(gee_exch_health)$corr[1]
(alpha = summary(gee_exch_health)$corr[1])
summary(gee_exch_health)$corr
summary(gee_exch_health)$corr
health = health %>% arrange(id, time)
gee_ar1 = geepack::geeglm(
health ~ time_months + treatment + agegroup + treatment:agegroup,
id = id,
data = health,
family = binomial("logit"),
corstr = "ar1"
)
summary(gee_ar1)
health
head(health,20)
head(health,10)
head(health)
ar1_coef = summary(gee_ar1)$corr[1]
ar1_coef
ar1_coef
corr_yi1_yi4 = ar1_coef^3
corr_yi1_yi4
coef(gee_ar1)
cov_ar1 = vcov(gee_ar1)
cov_ar1
cov_ar1 = vcov(gee_ar1)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
cov_ar1
OR_ar1 = exp(results_ar1["treatmentIntervention","Estimate"] +
results_ar1["treatmentIntervention:agegroup25-34","Estimate"])
results_ar1 = coef(gee_ar1)
OR_ar1 = exp(results_ar1["treatmentIntervention","Estimate"] +
results_ar1["treatmentIntervention:agegroup25-34","Estimate"])
results_ar1
OR_ar1 = exp(results_ar1["treatmentIntervention"] +
results_ar1["treatmentIntervention:agegroup25-34"])
results_ar1
OR_ar1 = exp(results_ar1["treatmentIntervention"] +
results_ar1["treatmentIntervention:agegroup25-34"])
results_ar1
results_ar1["treatmentIntervention"]
OR_ar1
OR_ar1 = exp(results_ar1[["treatmentIntervention"]] +
results_ar1["treatmentIntervention:agegroup25-34"])
OR_ar1
OR_ar1 = exp(results_ar1$"treatmentIntervention" +
results_ar1$"treatmentIntervention:agegroup25-34")
results_ar1 = coef(gee_ar1)
OR_ar1 = exp(results_ar1$"treatmentIntervention" +
results_ar1$"treatmentIntervention:agegroup25-34")
OR_ar1 = exp(results_ar1$`treatmentIntervention` +
results_ar1$"treatmentIntervention:agegroup25-34")
OR_ar1 = exp(results_ar1$`treatmentIntervention` +
results_ar1$`treatmentIntervention:agegroup25-34`)
results_ar1$`treatmentIntervention`
results_ar1$'treatmentIntervention'
results_ar1$treatmentIntervention
results_ar1$treatmentIntervention
OR_ar1 = exp(results_ar1[[treatmentIntervention]] +
results_ar1[[treatmentIntervention:agegroup25-34]])
OR_ar1 = exp(results_ar1[["treatmentIntervention"]] +
results_ar1[[treatmentIntervention:agegroup25-34]])
results_ar1[["treatmentIntervention"]]
OR_ar1 = exp(results_ar1[["treatmentIntervention"]] +
results_ar1[["treatmentIntervention:agegroup25-34"]])
OR_ar1
OR_ar1
SE_ar1 = sqrt(results_ar1["treatmentIntervention","Std. Error"]^2 +
results_ar1["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_ar1)
cov_ar1 = vcov(gee_ar1)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
SE_ar1 = sqrt(results_ar1["treatmentIntervention","Std. Error"]^2 +
results_ar1["treatmentIntervention:agegroup25-34","Std. Error"]^2 +
2 * cov_ar1)
results_ar1
gee_ar1
summary(gee_ar1)
std(gee_ar1)
se(gee_ar1)
summary(gee_ar1)
summary(gee_ar1)$coefficients
summary(gee_ar1)$coefficients[,Std.err]
stderr(
gee_ar1
)
summary(gee_ar1)$coefficients[,"Std.err"]
summary(gee_ar1)$coefficients[[],"Std.err"]]
summary(gee_ar1)$coefficients[,"Std.err"]
summary(gee_ar1)$coefficients
OR_ar1 = exp(coef(gee_ar1)[["treatmentIntervention"]] +
coef(gee_ar1)[["treatmentIntervention:agegroup25-34"]])
OR_ar1
results_ar1 = summary(gee_ar1)$coefficients
results_ar1 = summary(gee_ar1)$coefficients
SE_ar1 = sqrt(results_ar1["treatmentIntervention","Std.err"]^2 +
results_ar1["treatmentIntervention:agegroup25-34","Std.err"]^2 +
2 * cov_ar1)
cov_ar1 = vcov(gee_ar1)["treatmentIntervention:agegroup25-34","treatmentIntervention"]
results_ar1 = summary(gee_ar1)$coefficients
SE_ar1 = sqrt(results_ar1["treatmentIntervention","Std.err"]^2 +
results_ar1["treatmentIntervention:agegroup25-34","Std.err"]^2 +
2 * cov_ar1)
lowerCI_ar1 = OR_ar1 / exp(1.96*SE_ar1)
upperCI_ar1 = OR_ar1 * exp(1.96*SE_ar1)
CI_ar1 = c(lowerCI_ar1, upperCI_ar1)
CI_ar1
wald = anova(gee_ar1, test = "Wald")
wald = lme4::anova(gee_ar1, test = "Wald")
wald = anova(gee_ar1, test = "Wald")
wald = gee::anova(gee_ar1, test = "Wald")
gee_ar1_main = geeglm(
health ~ treatment + agegroup + time_months , id = id,
data  = health,
family = binomial (link = "logit"),
corstr = "ar1")
gee_ar1_main = geepack::geeglm(
health ~ treatment + agegroup + time_months , id = id,
data  = health,
family = binomial (link = "logit"),
corstr = "ar1")
summary(gee_ar1_main)
wald = gee::anova(gee_ar1, gee_ar1_main, test = "Wald")
wald = anova(gee_ar1, gee_ar1_main, test = "Wald")
anova(gee_ar1, gee_ar1_main, test = "Wald")
gee_ar1_main = geepack::geeglm(
health ~ treatment + agegroup + time_months , id = id,
data  = health,
family = binomial (link = "logit"),
corstr = "ar1")
anova(gee_ar1, gee_ar1_main, test = "Wald")
here::i_am("report.Rmd")
proj_data <- readRDS(
file = here::here("output/data_clean.rds")
)
packageVersion("ggplot2")
q()
getwd()
setwd("D:/zls/Emory/Courses/2024 Fall/DATA 550/Practices/Practice9W10 - 1118/with_cy/collaborating_using_renv")
.libPaths()
renv::activate()
.libPaths()
ls
ls
getwd()
ls
getwd()
.libPaths()
.libPaths()
getwd()
renv::activate()
renv::status()
.libPaths()
ls
renv::activate()
renv::activate()
rm(list=ls())
renv::activate()
renv::deactivate()
renv::activate()
.libPaths()
.libPaths()
renv::restore()
renv::restore()
